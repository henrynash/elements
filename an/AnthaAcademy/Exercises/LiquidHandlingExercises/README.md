## Exercises: Writing protocols

### Pre-requisites
- Lesson 1 of the Antha Academy
- golang book chapters 5-9

## Making a new element
On the command line, a new template antha element and corresponding execution bundle can be generated by running the ```antha new element``` command.

The protocol name is case sensitive and the first letter must be upper case. 

To make an new element called SplitSample we'd run the following command:

```bash
antha new element SplitSample
```

A folder will be created containing two output files:

The Antha element should look like this:

```go 
// Protocol SplitSample performs something.
//
// All of this text should be used to describe what this protocol does.  It
// should begin with a one sentence summary begining with "Protocol X...". If
// neccessary, a empty line with a detailed description can follow (like this
// description does).
//
// Spend some time thinking of a good protocol name as this is the name by
// which this protocol will be referred. It should convey the purpose and scope
// of the protocol to an outsider and should suggest an obvious
// parameterization. 
//
// Protocol names are also case-sensitive, so try to use a consistent casing
// scheme.
//
// Examples of bad names:
//   - MyProtocol
//   - GeneAssembly
//   - WildCAPSsmallANDLARGE
//
// Better names:
//   - Aliquot
//   - TypeIIsConstructAssembly
protocol SplitSample

// Place golang packages to import here
import (
	"github.com/antha-lang/antha/antha/anthalib/wtype"
	"github.com/antha-lang/antha/antha/anthalib/mixer"
)

// Parameters to this protocol
Parameters {
	A float64
	B float64
	Option bool
	String string
	StringArray []string
	VolumeA wunit.Volume
	VolumeB wunit.Volume
}

// Output data of this protocol
Data {
	Sum float64
}

// Physical inputs to this protocol
Inputs {
	ComponentA *wtype.LHComponent
	ComponentB *wtype.LHComponent
}

// Physical outputs to this protocol
Outputs {
	MixedComponent *wtype.LHComponent
}

// Conditions to run on startup
Setup {

}

// The core process for this protocol. These steps are executed for each input.
Steps {
	Sum = A + B
	sampleA := mixer.Sample(ComponentA, VolumeA)
	sampleB := mixer.Sample(ComponentB, VolumeB)
	MixedComponent = Mix(sampleA, sampleB)
}

// Run after controls and a steps block are completed to post process any data
// and provide downstream results
Analysis {

}

// A block of tests to perform to validate that the sample was processed
// correctly. Optionally, destructive tests can be performed to validate
// results on a dipstick basis
Validation {

}

```

The Bundle file should look like this:

```json
{
  "processes": {
    "Process1": {
      "component": "SplitSample"
    }
  },
  "connections": null,
  "parameters": {
    "Process1": {
      "A": 2.99,
      "B": -1,
      "ComponentA": "water",
      "ComponentB": "water",
      "Option": false,
      "String": "Example",
      "StringArray": [
        "A",
        "B",
        "C"
      ],
      "VolumeA": "1ul",
      "VolumeB": "2ul"
    }
  },
  "config": null
}
```

### Important!
To use anthabuild to compile the antha file the an file will need to be within the antha-lang/elements/an folder. 

Otherwise the anthabuild command should be appended with AN_DIRS=<targetdirectory>.

e.g. 
```sh
anthabuild AN_DIRS=$GOPATH/src/github.com/my-antha-elements
```

## Excercises
1. Start with [Exercise 1](Exercise1_SplitSample/Exercise1_SplitSample.an) and follow the comments.

## Next Steps
Work your way through all the exercises and lesson folders following the comments in the antha element (.an) files.

